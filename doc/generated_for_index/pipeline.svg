<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.4 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="402pt" height="350pt"
 viewBox="0.00 0.00 402.00 350.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 345.62)">

<polygon fill="white" stroke="none" points="-4,4 -4,-345.62 398.02,-345.62 398.02,4 -4,4"/>
<!-- node_0 -->
<g id="node_0" class="node">

<g id="a_node_0"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 41, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;baskets = skrub.var(&quot;baskets&quot;, baskets_df)">
<polygon fill="none" stroke="black" points="153.4,-209.08 73,-209.08 73,-184.81 153.4,-184.81 153.4,-209.08"/>
<polygon fill="none" stroke="black" points="157.4,-213.08 69,-213.08 69,-180.81 157.4,-180.81 157.4,-213.08"/>
<text xml:space="preserve" text-anchor="middle" x="113.2" y="-191.92" font-family="sans-serif" font-size="12.00">Var &#39;baskets&#39;</text>
</a>
</g>
</g>
<!-- node_1 -->
<g id="node_1" class="node">

<g id="a_node_1"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 44, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;basket_IDs = baskets[[&quot;basket_ID&quot;]].skb.mark_as_X()">
<polygon fill="#c6d5f0" stroke="black" points="229.9,-144.81 92.5,-144.81 92.5,-120.54 229.9,-120.54 229.9,-144.81"/>
<text xml:space="preserve" text-anchor="middle" x="161.2" y="-127.65" font-family="sans-serif" font-size="12.00">X: GetItem [&#39;basket_ID&#39;]</text>
</a>
</g>
</g>
<!-- node_0&#45;&gt;node_1 -->
<g id="edge5" class="edge">

<path fill="none" stroke="black" d="M125.07,-180.55C131.2,-172.6 138.76,-162.78 145.39,-154.19"/>
<polygon fill="black" stroke="black" points="148.08,-156.43 151.41,-146.38 142.53,-152.16 148.08,-156.43"/>
</g>
<!-- node_7 -->
<g id="node_7" class="node">

<g id="a_node_7"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 45, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;fraud_flags = baskets[&quot;fraud_flag&quot;].skb.mark_as_y()">
<polygon fill="#fad9c6" stroke="black" points="128.4,-84.54 0,-84.54 0,-60.27 128.4,-60.27 128.4,-84.54"/>
<text xml:space="preserve" text-anchor="middle" x="64.2" y="-67.38" font-family="sans-serif" font-size="12.00">y: GetItem &#39;fraud_flag&#39;</text>
</a>
</g>
</g>
<!-- node_0&#45;&gt;node_7 -->
<g id="edge9" class="edge">

<path fill="none" stroke="black" d="M102.59,-180.4C96.24,-170.55 88.43,-157.35 83.2,-144.81 76.63,-129.06 71.76,-110.4 68.59,-96.1"/>
<polygon fill="black" stroke="black" points="72.02,-95.41 66.56,-86.33 65.17,-96.83 72.02,-95.41"/>
</g>
<!-- node_6 -->
<g id="node_6" class="node">

<g id="a_node_6"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 50, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;features = basket_IDs.merge(aggregated_products, on=&quot;basket_ID&quot;)">
<polygon fill="none" stroke="black" points="263.77,-84.54 146.62,-84.54 146.62,-60.27 263.77,-60.27 263.77,-84.54"/>
<text xml:space="preserve" text-anchor="middle" x="205.2" y="-67.38" font-family="sans-serif" font-size="12.00">CallMethod &#39;merge&#39;</text>
</a>
</g>
</g>
<!-- node_1&#45;&gt;node_6 -->
<g id="edge3" class="edge">

<path fill="none" stroke="black" d="M169.89,-120.16C175.56,-112.66 183.11,-102.66 189.77,-93.84"/>
<polygon fill="black" stroke="black" points="192.38,-96.19 195.61,-86.1 186.79,-91.97 192.38,-96.19"/>
</g>
<!-- node_2 -->
<g id="node_2" class="node">

<g id="a_node_2"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 40, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;products = skrub.var(&quot;products&quot;, products_df)">
<polygon fill="none" stroke="black" points="363.65,-337.62 278.75,-337.62 278.75,-313.35 363.65,-313.35 363.65,-337.62"/>
<polygon fill="none" stroke="black" points="367.65,-341.62 274.75,-341.62 274.75,-309.35 367.65,-309.35 367.65,-341.62"/>
<text xml:space="preserve" text-anchor="middle" x="321.2" y="-320.46" font-family="sans-serif" font-size="12.00">Var &#39;products&#39;</text>
</a>
</g>
</g>
<!-- node_3 -->
<g id="node_3" class="node">

<g id="a_node_3"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 48, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;aggregated_products = products.groupby(&quot;basket_ID&quot;).agg(">
<polygon fill="none" stroke="black" points="384.65,-273.35 257.75,-273.35 257.75,-249.08 384.65,-249.08 384.65,-273.35"/>
<text xml:space="preserve" text-anchor="middle" x="321.2" y="-256.19" font-family="sans-serif" font-size="12.00">CallMethod &#39;groupby&#39;</text>
</a>
</g>
</g>
<!-- node_2&#45;&gt;node_3 -->
<g id="edge8" class="edge">

<path fill="none" stroke="black" d="M321.2,-309.09C321.2,-301.82 321.2,-293 321.2,-284.97"/>
<polygon fill="black" stroke="black" points="324.7,-285.23 321.2,-275.23 317.7,-285.23 324.7,-285.23"/>
</g>
<!-- node_4 -->
<g id="node_4" class="node">

<g id="a_node_4"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 48, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;aggregated_products = products.groupby(&quot;basket_ID&quot;).agg(">
<polygon fill="none" stroke="black" points="373.02,-209.08 269.38,-209.08 269.38,-184.81 373.02,-184.81 373.02,-209.08"/>
<text xml:space="preserve" text-anchor="middle" x="321.2" y="-191.92" font-family="sans-serif" font-size="12.00">CallMethod &#39;agg&#39;</text>
</a>
</g>
</g>
<!-- node_3&#45;&gt;node_4 -->
<g id="edge7" class="edge">

<path fill="none" stroke="black" d="M321.2,-248.79C321.2,-240.89 321.2,-230.12 321.2,-220.52"/>
<polygon fill="black" stroke="black" points="324.7,-220.81 321.2,-210.81 317.7,-220.81 324.7,-220.81"/>
</g>
<!-- node_5 -->
<g id="node_5" class="node">

<g id="a_node_5"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 49, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;skrub.choose_from((&quot;mean&quot;, &quot;max&quot;, &quot;count&quot;))).reset_index()">
<polygon fill="none" stroke="black" points="394.02,-144.81 248.38,-144.81 248.38,-120.54 394.02,-120.54 394.02,-144.81"/>
<text xml:space="preserve" text-anchor="middle" x="321.2" y="-127.65" font-family="sans-serif" font-size="12.00">CallMethod &#39;reset_index&#39;</text>
</a>
</g>
</g>
<!-- node_4&#45;&gt;node_5 -->
<g id="edge6" class="edge">

<path fill="none" stroke="black" d="M321.2,-184.52C321.2,-176.62 321.2,-165.85 321.2,-156.25"/>
<polygon fill="black" stroke="black" points="324.7,-156.54 321.2,-146.54 317.7,-156.54 324.7,-156.54"/>
</g>
<!-- node_5&#45;&gt;node_6 -->
<g id="edge4" class="edge">

<path fill="none" stroke="black" d="M298.28,-120.16C281.12,-111.54 257.4,-99.63 238.2,-89.98"/>
<polygon fill="black" stroke="black" points="239.93,-86.93 229.42,-85.57 236.79,-93.19 239.93,-86.93"/>
</g>
<!-- node_8 -->
<g id="node_8" class="node">

<g id="a_node_8"><a xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;generate_data_ops_example_for_index.py&quot;, line 52, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;predictions = features.skb.apply(ExtraTreesClassifier(), y=fraud_flags)">
<polygon fill="none" stroke="black" points="212.27,-24.27 56.12,-24.27 56.12,0 212.27,0 212.27,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="134.2" y="-7.11" font-family="sans-serif" font-size="12.00">Apply ExtraTreesClassifier</text>
</a>
</g>
</g>
<!-- node_6&#45;&gt;node_8 -->
<g id="edge1" class="edge">

<path fill="none" stroke="black" d="M191.17,-59.89C181.45,-51.91 168.28,-41.11 157.05,-31.89"/>
<polygon fill="black" stroke="black" points="159.32,-29.22 149.37,-25.58 154.88,-34.63 159.32,-29.22"/>
</g>
<!-- node_7&#45;&gt;node_8 -->
<g id="edge2" class="edge">

<path fill="none" stroke="black" d="M78.03,-59.89C87.62,-51.91 100.6,-41.11 111.67,-31.89"/>
<polygon fill="black" stroke="black" points="113.79,-34.68 119.24,-25.59 109.31,-29.3 113.79,-34.68"/>
</g>
</g>
</svg>
