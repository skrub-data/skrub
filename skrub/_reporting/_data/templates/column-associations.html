<article class="margin-t-s flex-reverse wrapper gap-l">
    {% if summary["associations_skipped"] %}

    <div id="skipped-associations-alert" class="alert-info-dismissable flex space-between">
        <div class="alert-content shrinkable-text">
            <p>Computing pairwise associations was skipped. This is due to either:</p>
            <ul>
                <li>The dataframe exceeding the
                    <a href="https://skrub-data.org/stable/reference/generated/skrub.TableReport.html"><code>columns_threshold</code></a>
                    limit (default: 30).
                </li>
                <li>The <code>compute_associations</code> option being set to <code>False</code> (default: True).</li>
            </ul>

            <p>You can adjust this behavior in several ways:</p>
            <ul>
                <li>To fix it for a single report, change the parameters passed when creating <code>TableReport</code>:
                    <pre><code class="language-python">    report = TableReport(columns_threshold=50, compute_associations=True)</code></pre>
                </li>
                <li>To change the default columns threshold or compute associations during the current Python session, use <code>skrub.set_config</code>:
                    <pre><code class="language-python">    from skrub import set_config
    set_config(columns_threshold=50, compute_associations=True)</code></pre>
                </li>
                <li>To make the change permanent, use an environment variable:
                    <pre><code class="language-shell">    export SKB_COLUMNS_THRESHOLD=50
    export SKB_COMPUTE_ASSOCIATIONS=True</code></pre>
                </li>
            </ul>
            <p>
            Note that <code>TableReport</code> accepts these parameters:
            </p>
            <ul>
                <li>The <code>compute_associations</code> boolean indicating if the columns for which associations should be computed.</li>
                <li>The <code>columns_threshold</code> limits the number of columns for which columns should be plotted and associations should be computed.</li>
            </ul>
        </div>
    </div>

    {% elif summary.get("associations_skipped_polars_no_pyarrow", False) %}

    <div id="skipped-associations-polars-pyarrow-alert" class="alert-info-dismissable flex space-between">
        <div class="alert-content shrinkable-text">
            Computing pairwise associations is not available for Polars dataframes when PyArrow is not installed.
            To enable associations, install PyArrow: <code>pip install pyarrow</code>, or use a Pandas dataframe.
        </div>
    </div>

    {% elif summary["top_associations"] %}

    <div class="horizontal-scroll padding-b-s">
    <table class="pure-table">
        <thead>
            <tr>
                <th scope="col">Column 1</th>
                <th scope="col">Column 2</th>
                <th scope="col"><a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%27s_V">Cramér's V</a></th>
                <th scope="col"><a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson's Correlation</a></th>
            </tr>
        </thead>
        <tbody>
            {% for association in summary["top_associations"] %}
            <tr>
                <td class="elided">{{ association["left_column_name"] }}</td>
                <td class="elided">{{ association["right_column_name"] }}</td>
                <td
                    {% if association["cramer_v"] is gt high_association_threshold %}
                    class="critical"
                    {%- endif -%}
                    >
                    {{ association["cramer_v"] | format_number }}
                </td>
                <td>
                    {%- if not (association["pearson_corr"] | is_null) -%}
                    {{ association["pearson_corr"] | format_number }}
                    {%- endif -%}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>

    <div class="text shrinkable-text">
        The table below shows the strength of association between the most similar columns in the dataframe.
        <a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%27s_V">Cramér's V</a> statistic is a number between 0 and 1.
        When it is close to 1 the columns are strongly associated — they contain similar information.
        In this case, one of them may be redundant and for some models (such as linear models) it might be beneficial to remove it.
    </div>

    {% else %}
    No strong associations between any pair of columns were identified by a quick screening of a subsample of the dataframe.
    {% endif %}
</article>
